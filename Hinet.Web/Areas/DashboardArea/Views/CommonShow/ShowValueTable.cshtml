@using Hinet.Model.IdentityEntities
@using Hinet.Model.Entities
@using Hinet.Service.Common
@using Hinet.Service.Constant
@using Newtonsoft.Json
@model PageListResultBO<SelectListItem>

@{
    var lstData = Html.Raw(JsonConvert.SerializeObject(Model.ListItem));
}

<div class="modal-dialog" style="width:768px">

    <!-- Modal content-->
    <div class="modal-content">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal">&times;</button>
            <div class="center">
                <h4 class="modal-title">Tập giá trị</h4>
            </div>
        </div>
        <div class="modal-body">
            @using (Ajax.BeginForm("SearchShowValueTable", "commonshow", new { @area = "DashboardArea" }, new AjaxOptions()
            {
                HttpMethod = "POST",
                OnFailure = "AjaxFormError",
                OnSuccess = "AjaxFormSuccessImp",
            }, new { id = "createSearchDanhMucForm" }))
            {
            @Html.AntiForgeryToken()
            <div class="boxFormHeader">
                <span class="formHeader">1. Tìm kiếm</span>
            </div>
            <div class="form-inline">

                <div class="form-group">
                    <label class="control-label ">Tìm theo giá trị nhập</label>
                    @Html.TextBox("GiaTriNhapFilter", "", new { @class = "form-control" })
                </div>

                <div class="form-group">
                    <label class="control-label col-sm-4">Tìm theo giá trị hiển thị </label>

                    @Html.TextBox("GiaTriHienThiFilter", "", new { @class = "form-control" })
                </div>

                <button type="submit" class="btn btn-primary btn-sm"><i class="bi bi-search"></i> Tìm</button>
            </div>
            }
            <div class="boxFormHeader">
                <span class="formHeader">2. Danh sách</span>
            </div>
            <div>
                <div id="tbl-giaTriImport" class="hntbl-cover table-scroll">
                    <div class="table-wrap">
                        <table class="hinet-table table table-striped table-hover" cellspacing="0" width="100%">
                            <thead>
                                <tr>

                                    <th class="fixed-side">#</th>
                                    <th>Giá trị nhập</th>
                                    <th>Mô tả</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div class="modal-footer center">
                <button type="button" class="btn btn-default btn-sm" data-dismiss="modal">Đóng</button>
            </div>
        </div>
    </div>
</div>
<script>
    var lstData12 = eval(@lstData);
    var moduleTableSelectorModal ="#tbl-giaTriImport";
    function pagefunctionModal12(){
            var conf=[
                {
                    tdClass:"center width50 fixed-side",
                    isSort:false,
                    nameModel: "",
                    isCounter:true,
                    content: function (data) {
                        return "<input type='checkbox' />"
                    }
                },

				{
                    isSort: true,
                    tdClass:" ",
					nameModel:'MaQuocGia',
					content: function (data) {
					return data.Value
				}
				},
				{
                    isSort: true,
                    tdClass: " ",
					nameModel:'TenQuocGia',
					content: function (data) {
					return data.Text
				}
				},
            ];

            var getdatafunc=function(page,sortQuery,pageSize){
                $.ajax({
                    url: '/DashboardArea/commonshow/getDataShowValueTable',
                    type: 'post',
                    cache: false,
                    data:{"indexPage":page,"sortQuery":sortQuery,"pageSize":pageSize},
                    success: function (data) {
                        $(moduleTableSelectorModal).hinetTable("data",{
                            pageSize:pageSize!=-1?pageSize:data.Count,
                            pageIndex:page,
                            pagecount: data.TotalPage,
                            recordCount: data.Count,
                            listItem: data.ListItem,});
                    },
                    error: function (err) {
                        CommonJS.alert(xhr.responseText);
                    }
                });

            }

        var tblData = $(moduleTableSelectorModal).hinetTable("init",{
                pageSizeList:{size:[20,50,100,-1],label:['20','50','100','Tất cả']},
                pagecount: @Model.TotalPage,
                recordCount: @Model.Count,
                actionToolBar:'',
                getData:getdatafunc,
                listItem: lstData12,
                config: conf,
                showCheckBox: false
            });

        }

    function AfterSussessActionAjaxform(){
        $(moduleTableSelectorModal).hinetTable("reload");
    }
    function AjaxFormSuccessImp(rs) {
            $(moduleTableSelectorModal).hinetTable("data", {
                pageIndex: 1,
                pagecount: rs.TotalPage,
                recordCount: rs.Count,
                listItem: rs.ListItem,
            });
        }
        pagefunctionModal12();
</script>